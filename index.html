<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë³„ë‚œë³„ íƒ€ë¡œì¹´ë“œ</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: linear-gradient(120deg, #2d1b69 0%, #e9dbf2 100%);
      font-family: 'Arial', sans-serif;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
      flex-direction: column;
    }

    .container {
      max-width: 900px;
      width: 100%;
      padding: 20px;
      box-sizing: border-box;
    }

    h1 {
      color: white;
      margin-bottom: 30px;
    }

    .tarot-container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .card {
      width: 200px;
      height: 300px;
      perspective: 1000px;
      cursor: pointer;
    }

    .card-inner {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.6s;
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-front, .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 8px;
      overflow: hidden;
    }

    .card-front img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .card-back {
      background-color: #2d2a4a;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 16px;
      font-size: 12.5px;
      line-height: 1.4;
      white-space: pre-line;
      box-sizing: border-box;
      transform: rotateY(180deg) scale(0.95);
      text-align: center;
      box-shadow: 0 0 20px 8px rgba(255, 255, 255, 0.2), 0 0 30px 14px rgba(255, 255, 255, 0.1) inset;
    }

    .buttons {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .sub-button {
      background-color: rgba(255, 255, 255, 0.1);
      color: #fff;
      border: 1px solid rgba(255, 255, 255, 0.3);
      padding: 10px 20px;
      border-radius: 25px;
      font-size: 14px;
      cursor: pointer;
      backdrop-filter: blur(6px);
      transition: all 0.3s ease;
    }

    .sub-button:hover {
      background-color: rgba(255, 255, 255, 0.2);
      box-shadow: 0 0 10px 3px #fff;
      transform: translateY(-1px);
    }

    /* ê³µìœ ìš© ìº”ë²„ìŠ¤ëŠ” í™”ë©´ì—ì„œ ìˆ¨ê¹€ */
    #shareCanvas {
      position: absolute;
      left: -9999px;
      top: -9999px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>âœ¨ ë³„ë‚œë³„ íƒ€ë¡œì¹´ë“œ âœ¨</h1> <br> 

    <div class="tarot-container">
      <div class="card" onclick="flipCard(this)" data-message="ìƒˆë¡œìš´ ì¸ì—°ì´ ë‹¤ê°€ì˜µë‹ˆë‹¤.&#10;ë§ˆìŒì„ ì—´ê³  ê¸°ë‹¤ë ¤ë³´ì„¸ìš”." data-image="https://i.imgur.com/HRZrNvm.png">
        <div class="card-inner">
          <div class="card-front">
            <img src="https://i.imgur.com/HRZrNvm.png" alt="ì¹´ë“œ1 ì•ë©´">
          </div>
          <div class="card-back">
            ìƒˆë¡œìš´ ì¸ì—°ì´ ë‹¤ê°€ì˜µë‹ˆë‹¤.
            ë§ˆìŒì„ ì—´ê³  ê¸°ë‹¤ë ¤ë³´ì„¸ìš”.
          </div>
        </div>
      </div>
      <div class="card" onclick="flipCard(this)" data-message="í–‰ìš´ì§€ìˆ˜ê°€ ìƒìŠ¹í•˜ì˜€ìŠµë‹ˆë‹¤!&#10;ì˜ˆìƒì¹˜ ëª»í–ˆë˜ ìˆ˜ì…ì´ ë“¤ì–´ì˜¬ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤." data-image="https://i.imgur.com/NMbruAt.png">
        <div class="card-inner">
          <div class="card-front">
            <img src="https://i.imgur.com/NMbruAt.png" alt="ì¹´ë“œ2 ì•ë©´">
          </div>
          <div class="card-back">
            í–‰ìš´ì§€ìˆ˜ê°€ ìƒìŠ¹í•˜ì˜€ìŠµë‹ˆë‹¤!
            ì˜ˆìƒì¹˜ ëª»í–ˆë˜ ìˆ˜ì…ì´ ë“¤ì–´ì˜¬ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
          </div>
        </div>
      </div>
      <div class="card" onclick="flipCard(this)" data-message="ë°œ ë°‘ë§Œ ë³´ë©° ê±·ë‹¤ë³´ë©´ ì˜ˆìƒì¹˜ ëª»í•œ ê¸¸ë¡œ ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&#10;ë©€ë¦¬ ë³´ê³  ì§„í–‰í•˜ì‹œê¸¸!" data-image="https://i.imgur.com/OZB4t3N.png">
        <div class="card-inner">
          <div class="card-front">
            <img src="https://i.imgur.com/OZB4t3N.png" alt="ì¹´ë“œ3 ì•ë©´">
          </div>
          <div class="card-back">
            ë°œ ë°‘ë§Œ ë³´ë©° ê±·ë‹¤ë³´ë©´ ì˜ˆìƒì¹˜ ëª»í•œ ê¸¸ë¡œ ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            ë©€ë¦¬ ë³´ê³  ì§„í–‰í•˜ì‹œê¸¸!
          </div>
        </div>
      </div>
    </div>

    <div class="buttons">
      <button class="sub-button" onclick="goToStart()">ğŸ  ì²˜ìŒìœ¼ë¡œ</button>
      <button class="sub-button" onclick="sharePage()">ğŸ“¤ ê³µìœ í•˜ê¸°</button>
    </div>
  </div>

  <!-- ê³µìœ ìš© ì´ë¯¸ì§€ ìƒì„±ì„ ìœ„í•œ ìˆ¨ê²¨ì§„ ìº”ë²„ìŠ¤ -->
  <canvas id="shareCanvas" width="400" height="600"></canvas>

  <script>
    let selectedCard = null;
    let selectedCardData = null;

    function flipCard(card) {
      const isFlipped = card.classList.contains('flipped');

      if (!selectedCard) {
        card.classList.toggle('flipped');
        selectedCard = card;
        selectedCardData = {
          message: card.dataset.message.replace(/&#10;/g, '\n'),
          image: card.dataset.image
        };
        disableOtherCards(card);
      } else if (card === selectedCard) {
        card.classList.toggle('flipped');
      } else {
        alert("í•˜ë£¨ì— í•œ ë²ˆë§Œ ë½‘ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!\në‹¤ì‹œ ë½‘ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´, ì²˜ìŒìœ¼ë¡œ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”!");
      }
    }

    function disableOtherCards(exceptCard) {
      document.querySelectorAll('.card').forEach(card => {
        if (card !== exceptCard) {
          card.onclick = () => {
            alert("í•˜ë£¨ì— í•œ ë²ˆë§Œ ë½‘ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ë½‘ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´, ì²˜ìŒìœ¼ë¡œ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”!");
          };
        }
      });
    }

    function goToStart() {
      console.log("ì²˜ìŒìœ¼ë¡œ ë²„íŠ¼ í´ë¦­ë¨"); // ë””ë²„ê¹…ì„ ìœ„í•´ ì¶”ê°€
      window.location.href = "index.html"; // ì´ë™í•˜ë ¤ëŠ” í˜ì´ì§€ URL
    }

    async function createShareImage() {
      if (!selectedCardData) return null;

      const canvas = document.getElementById('shareCanvas');
      const ctx = canvas.getContext('2d');
      
      // ë°°ê²½ ê·¸ë¼ë””ì–¸íŠ¸
      const gradient = ctx.createLinearGradient(0, 0, 400, 600);
      gradient.addColorStop(0, '#2d1b69');
      gradient.addColorStop(1, '#e9dbf2');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, 400, 600);

      // ì œëª©
      ctx.fillStyle = 'white';
      ctx.font = 'bold 24px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('âœ¨ ë³„ë‚œë³„ íƒ€ë¡œì¹´ë“œ âœ¨', 200, 50);

      return new Promise((resolve) => {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        img.onload = function() {
          // ì¹´ë“œ ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
          const cardX = 100;
          const cardY = 80;
          const cardWidth = 200;
          const cardHeight = 300;
          
          ctx.drawImage(img, cardX, cardY, cardWidth, cardHeight);

          // í…Œë‘ë¦¬
          ctx.strokeStyle = 'white';
          ctx.lineWidth = 3;
          ctx.strokeRect(cardX, cardY, cardWidth, cardHeight);

          // ë©”ì‹œì§€ ë°°ê²½
          ctx.fillStyle = 'rgba(45, 42, 74, 0.9)';
          ctx.fillRect(50, 400, 300, 120);
          ctx.strokeStyle = 'white';
          ctx.lineWidth = 2;
          ctx.strokeRect(50, 400, 300, 120);

          // ë©”ì‹œì§€ í…ìŠ¤íŠ¸
          ctx.fillStyle = 'white';
          ctx.font = '16px Arial';
          ctx.textAlign = 'center';
          
          const lines = selectedCardData.message.split('\n');
          const lineHeight = 25;
          const startY = 430;
          
          lines.forEach((line, index) => {
            ctx.fillText(line, 200, startY + (index * lineHeight));
          });

          // í•˜ë‹¨ í…ìŠ¤íŠ¸
          ctx.font = '14px Arial';
          ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
          ctx.fillText('ì˜¤ëŠ˜ì˜ ìš´ì„¸ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!', 200, 560);

          resolve(canvas.toDataURL('image/png'));
        };
        img.src = selectedCardData.image;
      });
    }
function goToStart() {
  console.log("ì²˜ìŒìœ¼ë¡œ ë²„íŠ¼ í´ë¦­ë¨"); // ë””ë²„ê¹…ì„ ìœ„í•´ ì¶”ê°€
  window.location.href = "https://kimjiwoow.github.io/-/"; // ì›í•˜ëŠ” URLë¡œ ì´ë™
}

    // êµ¬ì‹ ë¸Œë¼ìš°ì €ìš© í´ë¦½ë³´ë“œ ë³µì‚¬ í•¨ìˆ˜
    function fallbackCopyTextToClipboard(text) {
      const textArea = document.createElement("textarea");
      textArea.value = text;
      
      // í™”ë©´ì— ë³´ì´ì§€ ì•Šê²Œ ì„¤ì •
      textArea.style.position = "fixed";
      textArea.style.top = "-1000px";
      textArea.style.left = "-1000px";
      textArea.style.width = "2em";
      textArea.style.height = "2em";
      textArea.style.padding = "0";
      textArea.style.border = "none";
      textArea.style.outline = "none";
      textArea.style.boxShadow = "none";
      textArea.style.background = "transparent";
      
      document.body.appendChild(textArea);
      textArea.focus();
      textArea.select();
      
      try {
        const successful = document.execCommand('copy');
        document.body.removeChild(textArea);
        return successful;
      } catch (err) {
        document.body.removeChild(textArea);
        return false;
      }
    }

    // í´ë¦½ë³´ë“œ ë³µì‚¬ í•¨ìˆ˜ (ëª¨ë“  ë¸Œë¼ìš°ì € í˜¸í™˜)
    async function copyToClipboard(text) {
      // ìµœì‹  ë¸Œë¼ìš°ì €ì—ì„œ navigator.clipboard ì‚¬ìš© ì‹œë„
      if (navigator.clipboard && window.isSecureContext) {
        try {
          await navigator.clipboard.writeText(text);
          return true;
        } catch (err) {
          console.log('navigator.clipboard ì‹¤íŒ¨, fallback ì‹œë„');
          return fallbackCopyTextToClipboard(text);
        }
      } else {
        // êµ¬ì‹ ë¸Œë¼ìš°ì €ë‚˜ ë¹„ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ì—ì„œ fallback ì‚¬ìš©
        return fallbackCopyTextToClipboard(text);
      }
    }

    async function sharePage() {
      if (!selectedCardData) {
        alert('ë¨¼ì € ì¹´ë“œë¥¼ ë½‘ì•„ì£¼ì„¸ìš”!');
        return;
      }

      const shareText = `âœ¨ ë³„ë‚œë³„ íƒ€ë¡œì¹´ë“œ âœ¨\n\nì˜¤ëŠ˜ì˜ ìš´ì„¸:\n${selectedCardData.message}\n\në‹¹ì‹ ë„ ìš´ì„¸ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!\n https://kimjiwoow.github.io/-/`;


      try {
        // ê³µìœ  ì´ë¯¸ì§€ ìƒì„±
        const shareImageUrl = await createShareImage();
        
        if (navigator.share && /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
          // ëª¨ë°”ì¼ì—ì„œ ì›¹ ê³µìœ  API ì‚¬ìš©
          try {
            // íŒŒì¼ ê³µìœ  ì‹œë„
            const response = await fetch(shareImageUrl);
            const blob = await response.blob();
            const file = new File([blob], 'tarot-result.png', { type: 'image/png' });
            
            await navigator.share({
              title: 'ë³„ë‚œë³„ íƒ€ë¡œì¹´ë“œ',
              text: shareText,
              files: [file]
            });
            return;
          } catch (error) {
            // íŒŒì¼ ê³µìœ  ì‹¤íŒ¨ ì‹œ í…ìŠ¤íŠ¸ë§Œ ê³µìœ 
            try {
              await navigator.share({
                title: 'ë³„ë‚œë³„ íƒ€ë¡œì¹´ë“œ',
                text: shareText
              });
              return;
            } catch (textShareError) {
              console.log('ì›¹ ê³µìœ  API ì‹¤íŒ¨, í´ë¦½ë³´ë“œ ë³µì‚¬ë¡œ ì „í™˜');
            }
          }
        }
        
        // ë°ìŠ¤í¬í†±ì´ë‚˜ ì›¹ ê³µìœ  API ì‹¤íŒ¨ ì‹œ í´ë¦½ë³´ë“œ ë³µì‚¬ + ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
        const copySuccess = await copyToClipboard(shareText);
        
        if (copySuccess) {
          // ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
          const link = document.createElement('a');
          link.download = 'tarot-result.png';
          link.href = shareImageUrl;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          
          alert('âœ… ìš´ì„¸ ë‚´ìš©ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ê³ \nì´ë¯¸ì§€ê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
        } else {
          // í´ë¦½ë³´ë“œ ë³µì‚¬ë„ ì‹¤íŒ¨í•œ ê²½ìš°
          alert('ğŸ“‹ ë³µì‚¬ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ í…ìŠ¤íŠ¸ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤:\n\n' + shareText);
        }
        
      } catch (error) {
        console.error('ê³µìœ  ì¤‘ ì˜¤ë¥˜:', error);
        // ëª¨ë“  ë°©ë²•ì´ ì‹¤íŒ¨í•œ ê²½ìš° ìµœí›„ì˜ ìˆ˜ë‹¨
        const copySuccess = await copyToClipboard(shareText);
        if (copySuccess) {
          alert('âœ… ìš´ì„¸ ë‚´ìš©ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
        } else {
          alert('ğŸ“‹ ê³µìœ  ë‚´ìš©:\n\n' + shareText);
        }
      }
    }
    <script>
function trackClick(eventName) {
  fetch("https://script.google.com/macros/s/~~YOUR_SCRIPT_ID~~/exec", {
    method: "POST",
    body: JSON.stringify({
      event: eventName,
      ua: navigator.userAgent
    }),
    headers: {
      "Content-Type": "application/json"
    }
  })
  .then(res => res.json())
  .then(data => console.log("âœ… Logged:", data))
  .catch(err => console.error("âŒ Logging failed:", err));
}

  </script>
</body>
</html>

